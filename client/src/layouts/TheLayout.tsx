import React, { ReactNode, FC } from "react";
import { useRouter } from "next/router";
import Head from "next/head";
import Link from "next/link";
import { Layout, Typography, Breadcrumb, Menu } from "antd";

const { Text } = Typography;
const { Header, Content } = Layout;

type Props = {
  children: ReactNode;
  htmlTitle: string;
  navTitle: string;
};

const pathToTitle: Record<string, string> = Object.freeze({
  "/": "Main",
  "/flora": "Flora",
  "/flora/login": "Login",
  "/asiv": "Asiv",
});

const mainBreadcrumbMenu: JSX.Element = (
  <Menu>
    <Menu.Item>
      <Link href="/flora">Flora</Link>
    </Menu.Item>
    <Menu.Item>
      <Link href="/asiv">Asiv</Link>
    </Menu.Item>
  </Menu>
);

const TheLayout: FC<Props> = ({
  children,
  htmlTitle,
  navTitle,
}): JSX.Element => {
  const router = useRouter();

  const pathSegments: string[] = router.pathname
    .split("/")
    .filter((path) => path);
  const breadcrumbItems: JSX.Element[] = pathSegments.map((_, idx) => {
    const currentPath: string = "/" + pathSegments.slice(0, idx + 1).join("/");
    return (
      <Breadcrumb.Item key={idx}>
        <Link href={currentPath}>{pathToTitle[currentPath]}</Link>
      </Breadcrumb.Item>
    );
  });

  return (
    <>
      <Head>
        <title>{htmlTitle}</title>
        <meta charSet="utf-8" />
        <meta name="viewport" content="initial-scale=1.0, width=device-width" />
      </Head>
      <Layout style={{ minHeight: "100vh" }}>
        {/* TOP NAV */}
        <Header>
          <Text strong style={{ color: "white", fontSize: "1.7rem" }}>
            {navTitle}
          </Text>
        </Header>

        {/* PAGE */}
        <Content style={{ padding: "1rem" }}>
          <Breadcrumb style={{ marginBottom: "1rem" }}>
            <Breadcrumb.Item overlay={mainBreadcrumbMenu}>
              <Link href="/">{pathToTitle["/"]}</Link>
            </Breadcrumb.Item>
            {breadcrumbItems}
          </Breadcrumb>
          {children}
        </Content>

        {/* BOTTOM NAV */}
        {/* <Footer style={{ textAlign: "center" }}>This is the footer</Footer> */}
      </Layout>
    </>
  );
};

export default TheLayout;
