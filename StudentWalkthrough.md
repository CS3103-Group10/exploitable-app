# Student Walkthrough

## Scenario

**_Flora_** is an online game portal where various in-game items are available for purchase with _Asiv_ credits.

**_Asiv_ credits** are online currency units managed by a third-party provider called _Asiv_. _Asiv_ credits are sold in exchange for real life currency at a fixed rate.

To complicate things, _Flora_ requires a **paid sign-up fee** in order to create an account as each account comes with a start-up bonus of 10 credits, so the online _Flora_ portal does not provide a way for new users to create an account.

However, as it turns out, it is revealed to you that the security aspects of the _Flora_ portal has been poorly implemented as the developers were either lazy or incompetent.

Your task is to basically act as an adversary and **buy an inordinate amount of items without spending a single cent** in order to destabilize the in-game economy.

## Setup

Ensure you have followed the README and launched both the server and client.

### You are expected to use the following tools

- Google Chrome
- Chrome DevTools
- Postman

### Knowledge prerequisites

1. You should generally know how the Client-Server communication works via HTTP.
2. You should know how common cyber attacks work.
3. You should be familiar with how Chrome DevTools / Postman works.

## Rules

1. You are not allowed to inspect the source code directly from the repository.
2. You are not allowed to directly refer to the tutor walkthrough.
3. You cannot directly interact with the database.
4. Proceed to the next task only after you have achieved the goal mentioned in each task.
5. You are not allowed to read ahead to the next task if you have not completed the earlier task.

## Deliverables

For each task, you must **document how you achieved each task's goal in detail** and **why it works**.

Then, **state and explain how you can implement an improved and safer design for the given vulnerability**.

## Task 1 - Breaking into an account

1. Access the _Flora_ web application by navigating to [localhost:3000](http://localhost:3000/) and clicking "_Flora_" on the navbar.

   > :bulb: You can assume that the _Flora_ and _Asiv_ are separate sites. Both pages on the same webpage for simplicity.

2. You should see the _Flora_ Shop as shown in the screenshot below:

    <img alt="Flora UI" src="https://raw.githubusercontent.com/CS3103-Group10/exploitable-app/main/preview/flora.png" width="80%"/>

    As you can see there are plenty of rare in-game products that we can purchase here. However, you can notice that even if you select any item, you cannot buy the item as the portal enforces that **you must login first**.

3. Click on the "_Login to continue_" button to access the login page.

    <img alt="Flora Login" src="https://raw.githubusercontent.com/CS3103-Group10/exploitable-app/main/preview/floraLogin.png" width="60%"/>

*  **GOAL**: Using your knowledge of common cyber attacks, gain access to an account.

    <details>
    <summary><b>Hint #1</b></summary>
    <p>
      The data storage for <em>Flora</em> is implemented with PostgreSQL.
    </p>
    </details>

## Task 2 - Finding the API key

Ensure that you are able to log in to an account before proceeding with this task.

1. Upon gaining access, you should now be able to see an additional panel in the _Flora_ Shop showing the products owned and any available credits.

    <img alt="Flora Login" src="https://raw.githubusercontent.com/CS3103-Group10/exploitable-app/main/preview/floraLoggedIn.png" width="60%"/>

2. You are given insider information that the _Flora_ web application uses an API key to **directly communicate** with the _Asiv_ server to authenticate itself as a trusted client of _Asiv_ in order to facilitate purchases.

- **GOAL**: Using Chrome DevTools, uncover the API key that _Flora_ uses.

    <details>
    <summary><b>Hint #1</b></summary>
    <p>
      Check the Sources tab of Chrome DevTools.
    </p>
    </details>

    <details>
    <summary><b>Hint #2</b></summary>
    <p>
      Try to observe what happens in the Network tab of Chrome DevTools when purchasing an item.
    </p>
    </details>

## Task 3 - Making a fraudulent purchase

Ensure that you have the API key that _Flora_ uses to communicate with _Asiv_ before proceeding with this task.

1. From either the source code or from observing the Network tab when sending a purchase request, study the HTTP request that _Flora_ is sending out.

*  **GOAL**: Knowing the API key and the HTTP request structure, use Postman to send a fake purchase for the most expensive item in the shop. Purchase the item at 0 credits.

    <details>
    <summary><b>Hint #1</b></summary>
    <p>
      <code>uid</code> and <code>pid</code> stands for User ID and Product ID.
    </p>
    </details>
